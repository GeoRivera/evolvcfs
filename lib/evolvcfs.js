"use strict";function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}(function(Global,document){var _curry=function(b){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];return function(){for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return function(c){return c.length===b.length?b.apply(void 0,_toConsumableArray(c)):_curry(b,c)}([].concat(_toConsumableArray(a),d))}},_compose=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return b.reduce(function(a,b){return function(){return a(b.apply(void 0,arguments))}})},_pipe=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return b.reduce(function(a,b){return function(){return b(a.apply(void 0,arguments))}})},_not=function(a){return function(){return!a.apply(void 0,arguments)}},_flip=function(a){return function(){for(var b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];return a.apply(void 0,_toConsumableArray(c.reverse()))}},_all=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return b.reduce(function(a,b){return!!(a&&b)},!0)},_any=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return b.reduce(function(a,b){return!!(a||b)},!1)},_box=function(a){return Array.isArray(a)?a:[a]},_toDate=function(a){return new Date(a)},_dtFieldToDate=function(a){return"[object String]"===Object.prototype.toString.call(a)?_toDate($$.getElement(a)):a},_where=function(a){var b=a.replace(/{{/g,"\\'\\'' + {{").replace(/}}/g," + '\\'\\' {{").replace(/{#/g,"' + {{").replace(/#}/g," + ' {{").split("{{");return"'"+b.reduce(function(a,b){return a+b},"")+"'"},_exists=function(a){return void 0!==a&&null!==a||!!a},_fromNullable=function(a){return void 0===a||!a},_isDateTimeField=function(a){return"DT"===$("#"+a).attr("type_code")||"D"===$("#"+a).attr("type_code")},_tryCatch=function(a){try{return a}catch(a){}},_isBlankDtTm=function(a){return""===getFormElement(a)&&""===getFormElement("time_"+a)},_isBlankDtOrTm=function(a){return""===getFormElement(a)||""===getFormElement("time_"+a)},_hasDtOrTm=_not(_isBlankDtTm),_isBlank=function(a){return _isDateTimeField(a)?_isBlankDtTm(a):""===getFormElement(a)},_hasValue=function(a){return _isDateTimeField(a)?_not(_isBlankDtOrTm)(a):_not(_isBlank)(a)},_wasModified=function(a){var b=$("#"+a).attr("old_value"),c=$$.getElement(a);return _exists(b)||$("#"+a).attr("old_value",""),!!_hasValue(a)&&_exists(b)&&b!==c},_keepValue=function(a){var b=$$.getElement(a);_hasValue(a)&&$("#"+a).attr("old_value",b)},_valueChanged=function(a){return _wasModified(a)&&_fromNullable(_keepValue(a))};return Global.$$={hasActiveEnrollment:function hasActiveEnrollment(peopleId,programId){var cond=eval(_where("program_info_id = {{programId}}")),has_enrollment=getDataValue("current_program_enrollment_view","people_id",peopleId,"program_name",cond),end_date=getDataValue("current_program_enrollment_view","people_id",peopleId,"end_date",cond);return has_enrollment&&!end_date},setXMLAttribute:function setXMLAttribute(a,b,c){a=_box(a).slice(),"number"==typeof c&&(c=c?"true":"false");for(var d=0;d<a.length;d++)_tryCatch($$.getNodeFromXML(a[d],formXML).setAttribute(b,c));refreshView(a[0])},getXMLAttribute:function getXMLAttribute(a,b){return _tryCatch($$.getNodeFromXML(a,formXML).getAttribute(b))},setRequired:function setRequired(a,b){a=_box(a).slice();var c=b?makeRequired:makeUnRequired;a.map(function(a){return _tryCatch(c({id:a}))})},setRequiredIfEntered:function setRequiredIfEntered(a){$$.setRequired(a,!_isBlank(a)),_isDateTimeField(a)&&$("#time_"+a).prev().attr("style",$("#caption_"+a).attr("style"))},setElement:function setElement(a,b){if(formElementExists(a)){var c=$$.getNodeFromXML(a,formXML),d="true"===c.getAttribute("is_modifiable");if(c.setAttribute("is_modifiable","true"),_isDateTimeField(a)){var e=b.split(/\s/i),f=e[0],g=(e[1]?e[1]:"")+(e[2]?e[2]:"");_tryCatch(setFormElement(a,f)),_tryCatch(setFormElement("time_"+a,g)),d&&$("#time_"+a).attr("disabled",!d)}else _tryCatch(setFormElement(a,b));d&&$("#"+a).attr("disabled",!d)}},getElement:function getElement(a,b){return _fromNullable(b)?getElementFromXML(formXML,a):getFormElement(a)},getClientAge:function getClientAge(a){return getDataValue("client_personal_view","people_id",a,"age")},getNodeFromXML:function getNodeFromXML(a,b){b=_fromNullable(b)?formXML:b;var c=null;return c="#"===a.charAt(0)?b.selectSingleNode("form_object/form_group/form_item[@caption='"+a.slice(1)+"']")||b.selectSingleNode("form_group/form_item[@caption='"+a.slice(1)+"']"):b.selectSingleNode("form_object/form_group/form_item[@column_name='"+a+"']")||b.selectSingleNode("form_group/form_item[@column_name='"+a+"']"),c},refreshView:function refreshView(a){xslTarget.innerHTML=transformXML(formXSL.XMLDocument.xml,formXML.xml),IsDirty()&&formState(a.form,!0)},showErrMsg:function showErrMsg(a,b){var c=$("#"+a)[0];$$.hideErrMsg(a),b="\u274C "+b,$(c).parent().parent().parent().prepend("<tr id=\""+c.id+"_err_row\"><td width=\"120\"></td><td rowSpan=\"1\" colSpan=\"1\"><div id="+c.id+"_err_msg >"+b+"</div></td></tr>"),$("#"+c.id+"_err_msg").css({margin:"10px 0px",padding:"10px",float:"left",width:"50%",color:"#D8000C",backgroundColor:"#FFD2D2",fontFamily:"arial",fontSize:".8em",verticalAlign:"middle"})},hideErrMsg:function hideErrMsg(a){$("#"+a+"_err_row").remove()},dtComp:function dtComp(a,b,c){return a=_dtFieldToDate(a),c=_dtFieldToDate(c),"="===b?a.toString()===c.toString():"equal"===b?a.toString()===c.toString():"!="===b?a.toString()!==c.toString():"different"===b?a.toString()!==c.toString():">"===b?a>c:"after"===b?a>c:">="===b?a>=c:"<"===b?a<c:"before"===b?a<c:"<="==b&&a<=c},dateIsAfter:function dateIsAfter(a,b,c){_valueChanged(a)&&!$$.dtComp(a,"after",b)&&_hasValue(a)?($$.showErrMsg(a,c),_hasValue(a)&&$$.setElement(a,"")):_hasValue(a)&&$$.hideErrMsg(a)},dateIsBefore:function dateIsBefore(a,b,c){!_valueChanged(a)||$$.dtComp(a,"before",b)||_isBlankDtTm(a)?!_isBlankDtTm(a)&&$$.hideErrMsg(a):($$.showErrMsg(a,c),!_isBlankDtTm(a)&&$$.setElement(a,""))},allDt:function allDt(a){var b="",c=a.reduce(function(a,c){var d=[].concat(_toConsumableArray(c)),e=d[0],f=d[1],g=d[2],h=d[3],i=$$.dtComp(e,f,g);return i||(b+=h+"\n",$$.setElement(e,"")),a&&i},!0);c||alert(b)},isAtMostHoursAfter:function isAtMostHoursAfter(a,b,c,d){a=_dtFieldToDate(a),c=_dtFieldToDate(c);var e=(c-a)/60/60/1e3;e>b&&(alert(d),$$.setElement(a,""))},eraseOnDisable:function eraseOnDisable(currEl,eraseList){eraseList=_box(eraseList),eraseList.map(function(el){_tryCatch(eval($$.getXMLAttribute(el,"disable_rule_code")))&&(_tryCatch(setFormElement(el,"")),$("#"+el+"_prompt").val(""))})},getFormElement:function(a){function b(){return a.apply(this,arguments)}return b.toString=function(){return a.toString()},b}(function(a){return getFormElement(a).replace(/[{}]/g,"")})},$$})(window.parent,document);